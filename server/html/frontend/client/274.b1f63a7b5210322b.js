"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[274],{2274:(Y,a,_)=>{_.r(a),_.d(a,{UsersPageModule:()=>I});var c=_(9808),e=_(1223),d=_(7562),p=_(2290),m=_(3071),U=_(7556),u=_(2382),l=_(4040);function h(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.name)}}function f(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"input",7),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().$implicit.name=o}),e.qZA()}if(2&s){const n=e.oxw().$implicit;e.Q6J("ngModel",n.name)}}function Z(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.identification)}}function T(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"input",8),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().$implicit.identification=o}),e.qZA()}if(2&s){const n=e.oxw().$implicit;e.Q6J("ngModel",n.identification)("maxlength",10)}}function x(s,i){if(1&s&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&s){const n=e.oxw().$implicit;e.xp6(1),e.Oqu(n.email)}}function C(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"input",7),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().$implicit.email=o}),e.qZA()}if(2&s){const n=e.oxw().$implicit;e.Q6J("ngModel",n.email)}}function b(s,i){if(1&s&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&s){const n=i.$implicit;e.Q6J("ngValue",n.id),e.xp6(1),e.Oqu(n.name)}}function M(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"select",27),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().$implicit.role=o}),e._uU(1,"\n                            "),e.YNc(2,b,2,2,"option",10),e._uU(3,"\n                        "),e.qZA()}if(2&s){const n=e.oxw().$implicit,t=e.oxw();e.Q6J("ngModel",n.role)("disabled",!0),e.xp6(2),e.Q6J("ngForOf",t.roles)}}function A(s,i){if(1&s&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&s){const n=i.$implicit;e.Q6J("ngValue",n.id),e.xp6(1),e.Oqu(n.name)}}function w(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"select",9),e.NdJ("ngModelChange",function(o){return e.CHM(n),e.oxw().$implicit.role=o}),e._uU(1,"\n                            "),e.YNc(2,A,2,2,"option",10),e.ALo(3,"orderBy"),e._uU(4,"\n                        "),e.qZA()}if(2&s){const n=e.oxw().$implicit,t=e.oxw();e.Q6J("ngModel",n.role),e.xp6(2),e.Q6J("ngForOf",e.xi3(3,2,t.roles,t.order))}}function J(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"button",29),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).edit_user()}),e._uU(1,"\n                                "),e._UZ(2,"i",30),e._uU(3,"\n                            "),e.qZA()}}function q(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().$implicit;return e.oxw().update_user(o)}),e._uU(1,"\n                                "),e._UZ(2,"i",31),e._uU(3,"\n                            "),e.qZA()}}function P(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().$implicit;return e.oxw().reset_user_password(o)}),e._uU(1,"\n                                "),e._UZ(2,"i",33),e._uU(3,"\n                            "),e.qZA()}}function E(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"button",34),e.NdJ("click",function(){return e.CHM(n),e.oxw(2).edit_user()}),e._uU(1,"\n                                "),e._UZ(2,"i",35),e._uU(3,"\n                            "),e.qZA()}}function v(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"button",32),e.NdJ("click",function(){e.CHM(n);const o=e.oxw().$implicit;return e.oxw().delete_user(o)}),e._uU(1,"\n                                "),e._UZ(2,"i",36),e._uU(3,"\n                            "),e.qZA()}}function N(s,i){if(1&s){const n=e.EpF();e.TgZ(0,"tr",16),e.NdJ("click",function(){const r=e.CHM(n).$implicit;return e.oxw().select_user(r)}),e._uU(1,"\n                    "),e.TgZ(2,"th",17),e._uU(3),e.qZA(),e._uU(4,"\n                    "),e.TgZ(5,"td"),e._uU(6,"\n                        "),e.YNc(7,h,2,1,"span",18),e._uU(8,"\n                        "),e.YNc(9,f,1,1,"input",19),e._uU(10,"\n                    "),e.qZA(),e._uU(11,"\n                    "),e.TgZ(12,"td"),e._uU(13,"\n                        "),e.YNc(14,Z,2,1,"span",18),e._uU(15,"\n                        "),e.YNc(16,T,1,2,"input",20),e._uU(17,"\n                    "),e.qZA(),e._uU(18,"\n                    "),e.TgZ(19,"td"),e._uU(20,"\n                        "),e.YNc(21,x,2,1,"span",18),e._uU(22,"\n                        "),e.YNc(23,C,1,1,"input",19),e._uU(24,"\n                    "),e.qZA(),e._uU(25,"\n                    "),e.TgZ(26,"td"),e._uU(27,"\n                        "),e.YNc(28,M,4,3,"select",21),e._uU(29,"\n                        "),e.YNc(30,w,5,5,"select",22),e._uU(31,"\n                    "),e.qZA(),e._uU(32,"\n                    "),e.TgZ(33,"td"),e._uU(34,"\n                        "),e.TgZ(35,"div",11),e._uU(36,"\n                            "),e.YNc(37,J,4,0,"button",23),e._uU(38,"\n                            "),e.YNc(39,q,4,0,"button",24),e._uU(40,"\n                            "),e.YNc(41,P,4,0,"button",25),e._uU(42,"\n                            "),e.YNc(43,E,4,0,"button",26),e._uU(44,"\n                            "),e.YNc(45,v,4,0,"button",25),e._uU(46,"\n                        "),e.qZA(),e._uU(47,"\n                    "),e.qZA(),e._uU(48,"\n                "),e.qZA()}if(2&s){const n=i.$implicit,t=e.oxw();e.xp6(3),e.hij("\n                        ",n.id,"\n                    "),e.xp6(4),e.Q6J("ngIf",t.selected_user!==n||t.selected_user==n&&!t.isEditing),e.xp6(2),e.Q6J("ngIf",t.selected_user==n&&t.isEditing),e.xp6(5),e.Q6J("ngIf",t.selected_user!==n||t.selected_user==n&&!t.isEditing),e.xp6(2),e.Q6J("ngIf",t.selected_user==n&&t.isEditing),e.xp6(5),e.Q6J("ngIf",t.selected_user!==n||t.selected_user==n&&!t.isEditing),e.xp6(2),e.Q6J("ngIf",t.selected_user==n&&t.isEditing),e.xp6(5),e.Q6J("ngIf",t.selected_user!==n||t.selected_user==n&&!t.isEditing),e.xp6(2),e.Q6J("ngIf",t.selected_user==n&&t.isEditing),e.xp6(7),e.Q6J("ngIf",!t.isEditing||t.selected_user!=n),e.xp6(2),e.Q6J("ngIf",t.selected_user==n&&t.isEditing),e.xp6(2),e.Q6J("ngIf",t.selected_user==n&&t.isEditing),e.xp6(2),e.Q6J("ngIf",t.selected_user==n&&t.isEditing),e.xp6(2),e.Q6J("ngIf",!t.isEditing||t.selected_user!=n)}}function y(s,i){if(1&s&&(e.TgZ(0,"option",28),e._uU(1),e.qZA()),2&s){const n=i.$implicit;e.Q6J("ngValue",n.id),e.xp6(1),e.Oqu(n.name)}}let Q=(()=>{class s{constructor(n,t,o,r){this.spinner=n,this.toastr=t,this.userDataService=o,this.authDataService=r,this.users=[],this.new_user={identification:"",name:"",email:"",role:1},this.selected_user={},this.roles=[{id:1,name:"Administrador"},{id:2,name:"Decano"},{id:3,name:"Director de Carrera"},{id:4,name:"Contabilidad"},{id:5,name:"Estudiante"}],this.isEditing=!1,this.order="id"}ngOnInit(){this.refresh()}refresh(){this.new_user.identification="",this.new_user.name="",this.new_user.email="",this.new_user.role=1,this.isEditing=!1,this.get_users()}select_user(n){this.selected_user=n}get_users(){this.spinner.show(),this.users=[],this.userDataService.get().then(n=>{this.spinner.hide(),this.users=n}).catch(n=>{console.log(n)})}create_user(){return this.spinner.show(),""==this.new_user.identification||""==this.new_user.name||""==this.new_user.email?(this.spinner.hide(),void this.toastr.error("La c\xe9dula, nombre y/o correo no pueden estar vacios.","Error")):this.validate_email(this.new_user.email)?void this.userDataService.create(this.new_user.identification,this.new_user.name,this.new_user.email,this.new_user.role).then(n=>{this.spinner.hide(),this.toastr.success("El usuario ha sido registrado correctamente.","Usuario Creado"),this.refresh()}).catch(n=>{console.log(n)}):(this.spinner.hide(),void this.toastr.error("El correo electr\xf3nico ingresado no es v\xe1lido.","Error"))}update_user(n){return this.spinner.show(),""==n.identification||""==n.name||""==n.email?(this.spinner.hide(),void this.toastr.error("La c\xe9dula, nombre y/o correo no pueden estar vacios.","Error")):this.validate_email(n.email)?void this.userDataService.update(n.id,n.identification,n.name,n.email,n.role).then(t=>{this.spinner.hide(),this.toastr.success("El usuario ha sido actualizado correctamente.","Usuario Actualizado"),this.refresh()}).catch(t=>{console.log(t)}):(this.spinner.hide(),void this.toastr.error("El correo electr\xf3nico ingresado no es v\xe1lido.","Error"))}delete_user(n){this.spinner.show(),this.userDataService.delete(n.id).then(t=>{this.spinner.hide(),this.toastr.success("El usuario ha sido eliminado correctamente.","Usuario Eliminado"),this.refresh()}).catch(t=>{console.log(t)})}reset_user_password(n){this.spinner.show(),this.authDataService.password_recovery(n.email).then(t=>{this.spinner.hide(),this.toastr.success("Pida al usuario revisar su correo electr\xf3nico para continuar.","Solicitud de Restablecimiento Enviada"),this.refresh()}).catch(t=>{console.log(t)})}edit_user(){this.isEditing=!this.isEditing}validate_email(n){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(n.toString())}}return s.\u0275fac=function(n){return new(n||s)(e.Y36(d.t2),e.Y36(p._W),e.Y36(m.K),e.Y36(U.e))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-users-page"]],decls:80,vars:13,consts:[[1,"display-5","mb-5"],[1,"row","d-flex","mb-5"],[1,"col-12","table-responsive"],[1,"table","table-hover","table-bordered"],[1,"table-light"],["scope","col"],[3,"click",4,"ngFor","ngForOf"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["type","text",1,"form-control",3,"ngModel","maxlength","ngModelChange"],[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"d-grid","gap-2","d-md-block"],["type","button",1,"btn","btn-success",3,"click"],[1,"fas","fa-plus"],["type","button",1,"btn","btn-primary","mb-5",3,"click"],[1,"fas","fa-redo"],[3,"click"],["scope","row"],[4,"ngIf"],["type","text","class","form-control",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","class","form-control",3,"ngModel","maxlength","ngModelChange",4,"ngIf"],["class","form-select",3,"ngModel","disabled","ngModelChange",4,"ngIf"],["class","form-select",3,"ngModel","ngModelChange",4,"ngIf"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button","class","btn btn-success",3,"click",4,"ngIf"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],["type","button","class","btn btn-warning",3,"click",4,"ngIf"],[1,"form-select",3,"ngModel","disabled","ngModelChange"],[3,"ngValue"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-edit"],[1,"fas","fa-save"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-key"],["type","button",1,"btn","btn-warning",3,"click"],[1,"fas","fa-ban"],[1,"fas","fa-trash"]],template:function(n,t){1&n&&(e.TgZ(0,"h1",0),e._uU(1,"Usuarios"),e.qZA(),e._uU(2,"\n"),e.TgZ(3,"div",1),e._uU(4,"\n    "),e.TgZ(5,"div",2),e._uU(6,"\n        "),e.TgZ(7,"table",3),e._uU(8,"\n            "),e.TgZ(9,"thead",4),e._uU(10,"\n                "),e.TgZ(11,"tr"),e._uU(12,"\n                    "),e.TgZ(13,"th",5),e._uU(14,"ID"),e.qZA(),e._uU(15,"\n                    "),e.TgZ(16,"th",5),e._uU(17,"Nombre"),e.qZA(),e._uU(18,"\n                    "),e.TgZ(19,"th",5),e._uU(20,"N\xfamero de c\xe9dula"),e.qZA(),e._uU(21,"\n                    "),e.TgZ(22,"th",5),e._uU(23,"Correo Electr\xf3nico"),e.qZA(),e._uU(24,"\n                    "),e.TgZ(25,"th",5),e._uU(26,"Rol"),e.qZA(),e._uU(27,"\n                    "),e.TgZ(28,"th",5),e._uU(29,"Acciones"),e.qZA(),e._uU(30,"\n                "),e.qZA(),e._uU(31,"\n            "),e.qZA(),e._uU(32,"\n            "),e.TgZ(33,"tbody"),e._uU(34,"\n                "),e.YNc(35,N,49,14,"tr",6),e.ALo(36,"orderBy"),e._uU(37,"\n                "),e.TgZ(38,"tr"),e._uU(39,"\n                    "),e._UZ(40,"td"),e._uU(41,"\n                    "),e.TgZ(42,"td"),e.TgZ(43,"input",7),e.NdJ("ngModelChange",function(r){return t.new_user.name=r}),e.qZA(),e.qZA(),e._uU(44,"\n                    "),e.TgZ(45,"td"),e.TgZ(46,"input",8),e.NdJ("ngModelChange",function(r){return t.new_user.identification=r}),e.qZA(),e.qZA(),e._uU(47,"\n                    "),e.TgZ(48,"td"),e.TgZ(49,"input",7),e.NdJ("ngModelChange",function(r){return t.new_user.email=r}),e.qZA(),e.qZA(),e._uU(50,"\n                    "),e.TgZ(51,"td"),e._uU(52,"\n                        "),e.TgZ(53,"select",9),e.NdJ("ngModelChange",function(r){return t.new_user.role=r}),e._uU(54,"\n                            "),e.YNc(55,y,2,2,"option",10),e.ALo(56,"orderBy"),e._uU(57,"\n                        "),e.qZA(),e._uU(58,"\n                    "),e.qZA(),e._uU(59,"\n                    "),e.TgZ(60,"td"),e._uU(61,"\n                        "),e.TgZ(62,"div",11),e._uU(63,"\n                            "),e.TgZ(64,"button",12),e.NdJ("click",function(){return t.create_user()}),e._uU(65,"\n                                "),e._UZ(66,"i",13),e._uU(67,"\n                            "),e.qZA(),e._uU(68,"\n                        "),e.qZA(),e._uU(69,"\n                    "),e.qZA(),e._uU(70,"\n                "),e.qZA(),e._uU(71,"\n            "),e.qZA(),e._uU(72,"\n        "),e.qZA(),e._uU(73,"\n    "),e.qZA(),e._uU(74,"\n"),e.qZA(),e._uU(75,"\n"),e.TgZ(76,"button",14),e.NdJ("click",function(){return t.refresh()}),e._uU(77,"\n    "),e._UZ(78,"i",15),e._uU(79," Refrescar\n"),e.qZA()),2&n&&(e.xp6(35),e.Q6J("ngForOf",e.xi3(36,7,t.users,t.order)),e.xp6(8),e.Q6J("ngModel",t.new_user.name),e.xp6(3),e.Q6J("ngModel",t.new_user.identification)("maxlength",10),e.xp6(3),e.Q6J("ngModel",t.new_user.email),e.xp6(4),e.Q6J("ngModel",t.new_user.role),e.xp6(2),e.Q6J("ngForOf",e.xi3(56,10,t.roles,t.order)))},directives:[c.sg,c.O5,u.Fj,u.JJ,u.On,u.nD,u.EJ,u.YN,u.Kr],pipes:[l.T],styles:[""]}),s})();var g=_(1196);const k=[{path:"",component:Q}];let F=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[g.Bz.forChild(k)],g.Bz]}),s})(),I=(()=>{class s{}return s.\u0275fac=function(n){return new(n||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[],imports:[[c.ez,F,u.u5,l.l]]}),s})()}}]);