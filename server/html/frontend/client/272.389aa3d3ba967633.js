"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[272],{2272:(M,_,o)=>{o.r(_),o.d(_,{NewRequestPageModule:()=>R});var c=o(9808),d=o(1816),e=o(1223),p=o(7562),h=o(2290),l=o(1196),m=o(9444),U=o(5362),f=o(9854),Z=o(5291),u=o(2382);const q=["fileUploader"];function b(n,i){if(1&n&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("ngValue",t.id),e.xp6(1),e.Oqu(t.name)}}function T(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"option",35),e.NdJ("click",function(){return e.CHM(t),e.oxw().get_subjects()}),e._uU(1),e.qZA()}if(2&n){const t=i.$implicit;e.Q6J("ngValue",t.id),e.xp6(1),e.Oqu(t.name)}}function w(n,i){1&n&&(e.ynx(0),e._uU(1,"\n        "),e.TgZ(2,"label",3),e._UZ(3,"i",36),e._uU(4," Agregue las materias a modificar"),e.qZA(),e._uU(5,"\n    "),e.BQk())}function A(n,i){1&n&&(e._uU(0,"\n        "),e.TgZ(1,"label",3),e._UZ(2,"i",36),e._uU(3," Agregue las materias a retirar"),e.qZA(),e._uU(4,"\n    "))}function v(n,i){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e._uU(1,"\n                "),e.TgZ(2,"th",37),e._uU(3),e.qZA(),e._uU(4,"\n                "),e.TgZ(5,"td"),e._uU(6),e.qZA(),e._uU(7,"\n                "),e.TgZ(8,"td"),e._uU(9,"\n                    "),e.TgZ(10,"button",38),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.oxw().remove_subject(a)}),e._uU(11,"\n                        "),e._UZ(12,"i",39),e._uU(13,"\n                    "),e.qZA(),e._uU(14,"\n                "),e.qZA(),e._uU(15,"\n            "),e.qZA()}if(2&n){const t=i.$implicit;e.xp6(3),e.Oqu(t.code),e.xp6(3),e.Oqu(t.name)}}function N(n,i){if(1&n&&(e.TgZ(0,"option",34),e._uU(1),e.qZA()),2&n){const t=i.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.Oqu(t.name)}}const C=[{path:"",component:(()=>{class n{constructor(t,s,r,a,g,y,P){this.spinner=t,this.toastr=s,this.route=r,this.subjectDataService=a,this.careerDataService=g,this.requestDataService=y,this.requestAttachmentDataService=P,this.user={},this.request_types=[{id:1,name:"Modificaci\xf3n de Carga Acad\xe9mica"},{id:2,name:"Retiro en Asignatura"}],this.careers=[],this.subjects=[],this.new_request={type:1,career:1,parameters:{student_message:""}},this.new_subjects=[]}ngOnInit(){this.route.queryParams.subscribe(t=>{const s=sessionStorage.getItem("token");this.user=(0,d.Z)(s),t.type&&(this.new_request.type=Number(t.type)),this.refresh()})}refresh(){this.new_request.parameters.student_message="",this.new_subjects=[],this.get_careers(),this.get_subjects()}reset(){this.file=null,this.fileUploader.nativeElement.value=null,this.refresh()}get_careers(){this.spinner.show(),this.careers=[],this.careerDataService.get().then(t=>{this.spinner.hide(),this.careers=t}).catch(t=>{console.log(t)})}get_subjects(){this.spinner.show(),this.subjects=[],this.subjectDataService.getByCareer(this.new_request.career).then(t=>{this.spinner.hide(),this.subjects=t}).catch(t=>{console.log(t)})}add_subject(t){this.new_subjects.includes(t)?this.toastr.error("La materia ya est\xe1 seleccionada.","Error"):this.new_subjects.push(t)}remove_subject(t){let s=this.new_subjects.indexOf(t);this.new_subjects.splice(s,1)}file_selected(t){this.file=t.target.files[0]}create_request(){if(this.spinner.show(),""==this.new_request.parameters.student_message)return this.spinner.hide(),void this.toastr.error("El campo de mensaje no puede estar vacio.","Error");if(0==this.new_subjects.length)return this.spinner.hide(),void this.toastr.error("La lista de materias no puede estar vacia.","Error");if(this.new_subjects.some(t=>t.career_id!==this.new_request.career))return this.spinner.hide(),void this.toastr.error("La lista de materias contiene materias de otra carrera.","Error");if(!this.file)return this.spinner.hide(),void this.toastr.error("Debe adjuntar un archivo.","Error");if(!["image/jpeg","image/png"].includes(this.file.type))return this.spinner.hide(),void this.toastr.error("Tipo de archivo no soportado.","Error");if(this.file.size>5242880)return this.spinner.hide(),void this.toastr.error("El archivo es muy grande.","Error");{const t=new FileReader;t.readAsDataURL(this.file),t.onload=()=>{const s=t.result.split(",")[1];this.requestAttachmentDataService.create(this.file.name,this.file.type,s,1).then(r=>{this.requestDataService.create(this.user.sub,this.new_request.career,this.new_request.type,this.new_request.parameters,r.id,this.new_subjects).then(a=>{this.spinner.hide(),this.toastr.success("La solicitud ha sido enviada correctamente.","Solicitud Enviada"),this.reset()}).catch(a=>{console.log(a)})}).catch(r=>{console.log(r)})}}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(p.t2),e.Y36(h._W),e.Y36(l.gz),e.Y36(m._),e.Y36(U.o),e.Y36(f.s),e.Y36(Z.Q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-new-request-page"]],viewQuery:function(t,s){if(1&t&&e.Gf(q,5),2&t){let r;e.iGM(r=e.CRH())&&(s.fileUploader=r.first)}},decls:136,vars:10,consts:[[1,"display-5","mb-5"],[1,"row","mb-5"],[1,"col-lg-6","col-md-12","mb-lg-0","mb-5"],[1,"form-label"],[1,"fas","fa-list-ul"],[1,"form-select",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"col-lg-6","col-md-12"],[1,"fas","fa-graduation-cap"],[3,"ngValue","click",4,"ngFor","ngForOf"],[1,"mb-5","table-responsive"],[4,"ngIf","ngIfElse"],["labelRetirar",""],[1,"table","table-bordered","table-hover"],[1,"table-light"],["scope","col"],[4,"ngFor","ngForOf"],[1,"d-grid","gap-2","d-md-block"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"mb-5"],[1,"fas","fa-edit"],["rows","10",1,"form-control",3,"ngModel","ngModelChange"],[1,"fas","fa-paperclip"],["role","alert",1,"alert","alert-info"],[1,"fas","fa-hand-holding-usd"],["role","alert",1,"alert","alert-warning"],[1,"fas","fa-info-circle"],["type","file",1,"form-control",3,"change"],["fileUploader",""],["type","button",1,"btn","btn-primary","mb-5",3,"click"],[1,"fas","fa-paper-plane"],["type","button",1,"btn","btn-danger","mb-5",3,"click"],[1,"fas","fa-ban"],[3,"ngValue"],[3,"ngValue","click"],[1,"fas","fa-book"],["scope","row"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-trash"]],template:function(t,s){if(1&t&&(e.TgZ(0,"h1",0),e._uU(1,"Crear Solicitud"),e.qZA(),e._uU(2,"\n"),e.TgZ(3,"div",1),e._uU(4,"\n    "),e.TgZ(5,"div",2),e._uU(6,"\n        "),e.TgZ(7,"label",3),e._UZ(8,"i",4),e._uU(9," Seleccione el tipo de solicitud"),e.qZA(),e._uU(10,"\n        "),e.TgZ(11,"select",5),e.NdJ("ngModelChange",function(a){return s.new_request.type=a}),e._uU(12,"\n            "),e.YNc(13,b,2,2,"option",6),e._uU(14,"\n        "),e.qZA(),e._uU(15,"\n    "),e.qZA(),e._uU(16,"\n    "),e.TgZ(17,"div",7),e._uU(18,"\n        "),e.TgZ(19,"label",3),e._UZ(20,"i",8),e._uU(21," Seleccione su carrera"),e.qZA(),e._uU(22,"\n        "),e.TgZ(23,"select",5),e.NdJ("ngModelChange",function(a){return s.new_request.career=a}),e._uU(24,"\n            "),e.YNc(25,T,2,2,"option",9),e._uU(26,"\n        "),e.qZA(),e._uU(27,"\n    "),e.qZA(),e._uU(28,"\n"),e.qZA(),e._uU(29,"\n"),e.TgZ(30,"div",10),e._uU(31,"\n    "),e.YNc(32,w,6,0,"ng-container",11),e._uU(33,"\n    "),e.YNc(34,A,5,0,"ng-template",null,12,e.W1O),e._uU(36,"\n    "),e.TgZ(37,"table",13),e._uU(38,"\n        "),e.TgZ(39,"thead",14),e._uU(40,"\n            "),e.TgZ(41,"tr"),e._uU(42,"\n                "),e.TgZ(43,"th",15),e._uU(44,"C\xf3digo"),e.qZA(),e._uU(45,"\n                "),e.TgZ(46,"th",15),e._uU(47,"Nombre"),e.qZA(),e._uU(48,"\n                "),e.TgZ(49,"th",15),e._uU(50,"Acci\xf3n"),e.qZA(),e._uU(51,"\n            "),e.qZA(),e._uU(52,"\n        "),e.qZA(),e._uU(53,"\n        "),e.TgZ(54,"tbody"),e._uU(55,"\n            "),e.YNc(56,v,16,2,"tr",16),e._uU(57,"\n            "),e.TgZ(58,"tr"),e._uU(59,"\n                "),e._UZ(60,"td"),e._uU(61,"\n                "),e.TgZ(62,"td"),e._uU(63,"\n                    "),e.TgZ(64,"select",5),e.NdJ("ngModelChange",function(a){return s.temp_subject=a}),e._uU(65,"\n                        "),e.YNc(66,N,2,2,"option",6),e._uU(67,"\n                    "),e.qZA(),e._uU(68,"\n                "),e.qZA(),e._uU(69,"\n                "),e.TgZ(70,"td"),e._uU(71,"\n                    "),e.TgZ(72,"div",17),e._uU(73,"\n                        "),e.TgZ(74,"button",18),e.NdJ("click",function(){return s.add_subject(s.temp_subject)}),e._uU(75,"\n                            "),e._UZ(76,"i",19),e._uU(77,"\n                        "),e.qZA(),e._uU(78,"\n                    "),e.qZA(),e._uU(79,"\n                "),e.qZA(),e._uU(80,"\n            "),e.qZA(),e._uU(81,"\n        "),e.qZA(),e._uU(82,"\n    "),e.qZA(),e._uU(83,"\n"),e.qZA(),e._uU(84,"\n"),e.TgZ(85,"div",20),e._uU(86,"\n    "),e.TgZ(87,"label",3),e._UZ(88,"i",21),e._uU(89," Explique a detalle su solicitud"),e.qZA(),e._uU(90,"\n    "),e.TgZ(91,"textarea",22),e.NdJ("ngModelChange",function(a){return s.new_request.parameters.student_message=a}),e.qZA(),e._uU(92,"\n"),e.qZA(),e._uU(93,"\n"),e.TgZ(94,"div",20),e._uU(95,"\n    "),e.TgZ(96,"label",3),e._UZ(97,"i",23),e._uU(98," Adjunte el comprobante de pago del derecho de solicitud"),e.qZA(),e._UZ(99,"br"),e._uU(100,"\n    "),e.TgZ(101,"div",24),e._uU(102,"\n        "),e._UZ(103,"i",25),e._uU(104," Deber\xe1 realizar una trasferencia bancaria o dep\xf3sito de "),e.TgZ(105,"b"),e._uU(106,"10 USD"),e.qZA(),e._uU(107," en la "),e.TgZ(108,"b"),e._uU(109,"Cuenta Corriente de Banco Pichincha No. 2100015196"),e.qZA(),e._uU(110," con los siguientes datos: "),e.TgZ(111,"b"),e._uU(112,"Raz\xf3n Social: Universidad Iberoamericana del Ecuador UNIBE"),e.qZA(),e._uU(113,", "),e.TgZ(114,"b"),e._uU(115,"RUC: 1792378133001"),e.qZA(),e._uU(116,".\n    "),e.qZA(),e._uU(117,"\n    "),e.TgZ(118,"div",26),e._uU(119,"\n        "),e._UZ(120,"i",27),e._uU(121," Tama\xf1o m\xe1ximo 5MB, formatos soportados: jpeg, jpg, png\n    "),e.qZA(),e._uU(122,"\n    "),e.TgZ(123,"input",28,29),e.NdJ("change",function(a){return s.file_selected(a)}),e.qZA(),e._uU(125,"\n"),e.qZA(),e._uU(126,"\n"),e.TgZ(127,"button",30),e.NdJ("click",function(){return s.create_request()}),e._uU(128,"\n    "),e._UZ(129,"i",31),e._uU(130," Enviar Solicitud\n"),e.qZA(),e._uU(131,"\n"),e.TgZ(132,"button",32),e.NdJ("click",function(){return s.reset()}),e._uU(133,"\n    "),e._UZ(134,"i",33),e._uU(135," Limpiar Formulario\n"),e.qZA()),2&t){const r=e.MAs(35);e.xp6(11),e.Q6J("ngModel",s.new_request.type),e.xp6(2),e.Q6J("ngForOf",s.request_types),e.xp6(10),e.Q6J("ngModel",s.new_request.career),e.xp6(2),e.Q6J("ngForOf",s.careers),e.xp6(7),e.Q6J("ngIf",1==s.new_request.type)("ngIfElse",r),e.xp6(24),e.Q6J("ngForOf",s.new_subjects),e.xp6(8),e.Q6J("ngModel",s.temp_subject),e.xp6(2),e.Q6J("ngForOf",s.subjects),e.xp6(25),e.Q6J("ngModel",s.new_request.parameters.student_message)}},directives:[u.EJ,u.JJ,u.On,c.sg,u.YN,u.Kr,c.O5,u.Fj],styles:["textarea[_ngcontent-%COMP%]{resize:none}"]}),n})()}];let j=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[l.Bz.forChild(C)],l.Bz]}),n})(),R=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[],imports:[[c.ez,j,u.u5]]}),n})()}}]);